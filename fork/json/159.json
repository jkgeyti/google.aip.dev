{"text": "---\nid: 159\nstate: approved\ncreated: 2019-07-26\nplacement:\n  category: design-patterns\n  order: 70\n---\n\n# Reading across collections\n\nSometimes, it is useful for a user to be able to retrieve resources across\nmultiple collections, or retrieve a single resource without needing to know\nwhat collection it is in.\n\n## Guidance\n\nAPIs **may** support reading resources across multiple collections by allowing\nusers to specify a `-` (the hyphen or dash character) as a wildcard character\nin a standard [`List`][aip-132] method:\n\n```\nGET /v1/publishers/-/books?filter=...\n```\n\n- The URI pattern **must** still be specified with `*` and permit the\n  collection to be specified; a URI pattern **must not** hard-code the `-`\n  character.\n- The method **must** explicitly document that this behavior is supported.\n- The resources provided in the response **must** use the canonical name of the\n  resource, with the actual parent collection identifiers (instead of `-`).\n- Services **may** support reading across collections on `List` requests\n  regardless of whether the identifiers of the child resources are guaranteed\n  to be unique. However, services **must not** support reading across\n  collections on `Get` requests if the child resources might have a collision.\n- Cross-parent requests **should not** support `order_by`. If they do, the\n  field **must** document that it is best effort. This is because cross-parent\n  requests introduce ambiguity around ordering, especially if there is\n  difficulty reaching a parent (see [AIP-217][]).\n\n**Important:** If listing across multiple collections introduces the\npossibility of partial failures due to unreachable parents (such as when\nlisting across locations), the method **must** indicate this following the\nguidance in [AIP-217][].\n\n### Unique resource lookup\n\nSometimes, a resource within a sub-collection has an identifier that is unique\nacross parent collections. In this case, it may be useful to allow a\n[`Get`][aip-131] method to retrieve that resource without knowing which parent\ncollection contains it. In such cases, APIs **may** allow users to specify the\nwildcard collection ID `-` (the hyphen or dash character) to represent any\nparent collection:\n\n```\nGET https://example.googleapis.com/v1/publishers/-/books/{book}\n```\n\n- The URI pattern **must** still be specified with `*` and permit the\n  collection to be specified; a URI pattern **must not** hard-code the `-`\n  character.\n- The method **must** explicitly document that this behavior is supported.\n- The resource name in the response **must** use the canonical name of the\n  resource, with actual parent collection identifiers (instead of `-`). For\n  example, the request above returns a resource with a name like\n  `publishers/123/books/456`, _not_ `publishers/-/books/456`.\n- The resource ID **must** be unique within parent collections.\n\n## Further reading\n\n- For partial failures due to unreachable resources, see [AIP-217][].\n\n[aip-131]: ./0131.md\n[aip-132]: ./0132.md\n[aip-217]: ./0217.md\n\n## Changelog\n\n- **2019-08-26**: Added a reference to guidance for unreachable resources.\n- **2019-08-01**: Changed the examples from \"shelves\" to \"publishers\", to\n  present a better example of resource ownership.\n"}