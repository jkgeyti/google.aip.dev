{"text": "---\nid: 149\nstate: approved\ncreated: 2021-02-12\nplacement:\n  category: fields\n  order: 100\n---\n\n# Unset field values\n\nIn many messages, many fields are optional: the user is not required to provide\nthem, or for output fields, the service might not populate the field.\n\nIn most cases, there is no meaningful difference between setting it to a\ndefault value (such as `0`) as opposed to not setting it at all; however,\noccasionally this distinction is meaningful.\n\n## Guidance\n\nServices defined in protocol buffers **should** use the `optional` keyword for\nprimitives if and only if it is necessary to distinguish setting the field to\nits default value (`0`, `false`, or empty string) from not setting it at all:\n\n```proto\n// A representation of a book in a library.\nmessage Book {\n  option (google.api.resource) = {\n    type: \"library.googleapis.com/Book\"\n    pattern: \"publishers/{publisher}/books/{book}\"\n  };\n\n  // The name of the book.\n  string name = 1 [(google.api.field_behavior) = IDENTIFIER];\n\n  // The rating for the book, from 0 to 5.\n  // 0 is distinct from no rating.\n  optional int32 rating = 2;\n}\n```\n\n**Important:** Services **should not** need to distinguish between the default\nvalue and unset most of the time; if an alternative design does not require\nsuch a distinction, it is usually preferred. In practice, this means `optional`\n**should** only ever be used for integers and floats.\n\n**Important:** Tracking field presence is *not* the same as documenting API\nfield behavior as defined in [AIP-203][]. For example, a field labeled with\n`optional` for presence tracking **may** also be annotated as\n`google.api.field_behavior = REQUIRED` if the field must be set. If you only\nwant to document the server perceived behavior of a field, read [AIP-203][].\n\n## Rationale\n\n### field behavior and `optional`\n\nThe field behavior annotation and `optional` label are not mutually exclusive,\nbecause they address different problems. The former,\n`google.api.field_behavior`, focuses on communicating the server's perception of\na field within the API e.g. if it is required or not, if it is immutable, etc.\nThe latter, proto3's `optional`, is a wire format and code generation option\nthat is strictly for toggling field presence tracking. While it might be\nconfusing for a field to be simultaneously annotated with\n`google.api.field_behavior = REQUIRED` and labeled as `optional`, they are\nunrelated in practice and can reasonably be used together.\n\n## Changelog\n\n- **2023-06-20**: Differentiate from field behavior documentation\n\n[AIP-203]: ./0203.md\n"}