{"text": "---\nid: 4233\nstate: approved\ncreated: 2018-06-22\n---\n\n# Automatic pagination\n\nMany API responses, particularly to list and search methods, are paginated\n([AIP-158][]). Users calling these methods are then required to implement their\nown pagination logic, which is common boilerplate.\n\n## Guidance\n\nClient libraries **may** provide automatic resolution of pagination (meaning\nthat it performs requests in the background on an as-needed basis).\n\nPagination can be inferred for an RPC when _all_ of the following conditions\nare met:\n\n- The request message contains an `int32 page_size` field.\n- The request message contains a `string page_token` field.\n- The response message contains a `string next_page_token` field.\n- The response message contains one non-primitive `repeated` field.\n\nClient library generators implementing this feature **must** ensure that it is\na backwards-compatible change to add client-side pagination functionality where\nit was previously absent.\n\n### Implementing pagination\n\nFor the client library to implement pagination (as defined by [AIP-158][]), it\n**should** use the `next_page_token` value from the response message to\npopulate the `page_token` value of an otherwise-identical request message,\ncontinuing indefinitely until the `next_page_token` value is empty.\n\n**Important:** Client libraries that are implementing automatic resolution of\npagination should only perform requests for future pages on an as-needed basis,\nand avoid greedily resolving potentially long and unnecessary result sets.\n\nClient libraries that are implementing automatic pagination **must** still\nprovide access to the individual fields on the response message, in the usual\nfashion.\n\n**Note:** If the response message has more than one non-primitive `repeated`\nfield, the first one (in order of appearance in the file _and_ field number) is\nused. If the first field by order of appearance in the message and the first\nfield by field number do not match, code generators that implement automatic\npagination **should** fail with an error.\n\n[aip-158]: ../0158.md\n"}